=== helm secret notes : ===


on va pouvoir lire, editer, modifier des secrets chiffrés 

Il faut installer le plugin helm secrets : 
helm plugin install https://github.com/futuresimple/helm-secrets

le pkg sops est également nécéssaire : 
sudo dpkg -i  sops_3.5.0_amd64.deb
sops is an editor of encrypted files that supports YAML, JSON, ENV, INI and BINARY formats and encrypts with AWS KMS, GCP KMS, Azure Key Vault and PGP

on va pouvoir examiner les clés gpg de notre poste :

gpg --list-keys                         
/home/boogie/.gnupg/pubring.kbx
-------------------------------
pub   rsa4096 2019-11-27 [SC]
      BEEC6B925B691F80D07E0C943EC38B7777777777
uid          [  ultime ] Bob Lapin <bob@lapin.net>
sub   rsa4096 2019-11-27 [E]

si on dispose d'un fichier .sops.yaml contenant l'empreinte de notre clé publique et que les secrets ont été chiffrés avec notre clé publique : alors on pourra le déchiffrer avec notre clé privée. 

on va désormais pouvoir utiliser les fonctions du plugins : 
ex: on déchiffre un secret : cela créé un fichier en local qu'on va pouvoir examiner avec un editeur classique : 
helm secrets dec helm-vars/devtools/secrets.srs.yaml
view  helm-vars/devtools/secrets.srs.yaml.dec

helm secrets view helm_vars/devtools/secrets.srs.yaml
