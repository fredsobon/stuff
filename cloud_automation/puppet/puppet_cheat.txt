==== several cheat - memos for a puppet usage ===

= puppet debugger = 
https://github.com/nwops/puppet-debugger

= cheat = 
http://lzone.de/cheat-sheet/Puppet


=== cmds : ===

-puppet apply 
-> pour tester un manifest / code puppet : 
puppet apply fichier.pp ou path/tochemin/fichier.pp
puppet apply helloworld.pp 
puppet apply /vagrant/manifests/helloworld.pp 

- puppet ressource 
-> pour afficher la config puppet pour une ressource donnee 
puppet resource file /tmp/testfile.txt
file { '/tmp/testfile.txt':
  ensure => 'absent',
}
puppet resource user root
user { 'root':
  ensure           => 'present',
  comment          => 'root',
  gid              => '0',
  home             => '/root',
  password         => '$1$v4K9E8Wj$gZIHJ5JtQL5ZGZXeqSSsd0',
  password_max_age => '99999',
  password_min_age => '0',
  shell            => '/bin/bash',
  uid              => '0',
}


- puppet facts find

pour afficher la liste de facts dispo 


- puppet facts render 
-> afficher la liste de facts sous differents formats.

On peut sortir la liste des facts sous differents formats :
-yaml :
[vagrant@client manifests]$ facter --yaml
[vagrant@client manifests]$ puppet facts render-as-yaml
- json :
[vagrant@client manifests]$ facter --json
[vagrant@client manifests]$ puppet facts render-as-json




= variables : =

toutes les variables dans puppet commencent avec un $ et sont en minuscule ; composées de lettres, underscore ou chiffres. Elles ne commencent pas par des majuscules, des chiffres et ne comportent pas de tiret.
Attention : les variables qui commencent par un _ sont uniquement dédiées au scope local : $_myvar : sera uniquement interprete dans notre manifest local.

Les types sont classiques :
$my_name  = 'joe'  < string
$my_token = 115    < number
$not_true = false  < booleen

une variable non initialisee sera considérée comme undef on peut creer une variable avec une valeur indefinie :

$my_var = undef

Le module stlib de puppetlabs peut nous permettre de voir de quel type est notre variable :
include stdlib
$myname = 'joe'
$mytype = typeof($myname)
- Numbers :
les nombres non entourés par des " ou des '  sont de type numeric
Les nombres commencant par un 0 sont des octals et sceux commencant par 0x des hexa

- Tableaux et hash :

$mylist = [1,3,5,7]
$mytab = ['yes',5,'lapin',5.3]
$mymy =['yop',['lala',5]]

on peut definir des variables a des valeurs dans des tableaux si le nombre de variables et de valeur sont identiques :

[$myvar, $yourvar , $var] = ['lapin', 3, true]   <<<< GOOD
[$myvar, $yourvar , $var] = ['lapin', 3]         <<<<< ERROR

Certaines fonctions demandent une liste de valeur en arguments a la place d'element de tableau.On peut utiliser '*' pour convertir les elements d'un tableau en éléments séparés par une virgule avec la syntaxe de type :
$myfonction(* $array_of_args) { ..}

