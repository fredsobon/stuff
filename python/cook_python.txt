=== notes misc tips python (glmf hf 86) ===


= socket : =

Etablir une connection entre deux machines (serveur /client) via un socket 
Deux elements :

- serveur : 

server.py

#!/usr/bin/env python3

import socket

HOST="127.0.0.1"
PORT="8000"

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    server.bind((HOST,PORT))
except socket.error:
    print('impossible to link socket to adress : {}:{}'.format(HOST,PORT) 
	exit(1)
print('server {}:{} is waiting ...'.format(HOST,PORT) 

while True:
	server.listen(2)
	connexion, adress = server.accept()
	print('New connexion from client {}:{}'format(address[0], address[1]))

	connexion.send('connexion established'.encode('utf8'))
	while True:
		msg = connexion.recv(1024).decode('utf8')
		if msg.upper() == 'Quit':
			break
		print('>> ', msg)
		msgToSend = input('> ')
		connexion.send(msgToSend.encode('utf8'))

	connexion.send('quit'.encode('utf8'))
	connexion.close()
	print('connexion is closing ...)
	print('waiting for a new connexion')


client.py :

import socket


HOST="127.0.0.7"
PORT="8000"

server = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
	connexion.connect((HOST,PORT))
	except socket.error:
    print('impossible to link socket to adress : {}:{}'.format(HOST,PORT) 
	exit(1)

print('connexion established on {}:{}'.format(HOST,PORT))

while True
    msg = connexion.recv(1024).decode('utf8')
    if msg.upper() == 'Quit':
    break
    print('>> ', msg)
    msgToSend = input('> ')
    connexion.send(msgToSend.encode('utf8'))

print('connexion is closing')
connexion.close()






