=== notes en vrac exemple irules ===


- redirection vers un pool quand la requette contient un domain et un pattern Ã  la fin de  l'uri 


when HTTP_REQUEST {
	if { [HTTP::host] equals "lapin.com" and [HTTP::uri] ends_with "/carotte" } 
               {    
                   HTTP::header insert X-Forwarded-Proto "https"
                   pool lapin_web
               }
        }


- redirection vers un pool quand la requette concerne un domaine suivi de l'uri contenant un pattern inclu dans un wildcard :

when HTTP_REQUEST { 
 switch -glob [string tolower [HTTP::host][HTTP::uri]] {
  "www.lapin.*/carotte*" {
    HTTP::header insert X-Forwarded-Proto "https"
    pool lapin_pool 
    }
  }
}


- redirection vers un pool quand la requette concerne un domaine strict et une url contenant un pattern suivi d'un wildcard : 

A check ! 
when HTTP_REQUEST {
    if { [HTTP::host] equals "www.lapin.net" and [HTTP::uri] contains "/carotte*" }
               {    
                   HTTP::header insert X-Forwarded-Proto "https"
                   pool lapin_pool
               }



- redirection vers un pool avec reecriture d'url regexp :

https://devcentral.f5.com/articles/irules-101-10-regular-expressions

Avant :  
http://lapin.com/a/123/documents/bla
 regsub -nocase -all {^/[a-z1-9]+/[a-z1-9]+/documents} [HTTP::uri] "/new/documents" uri
 HTTP::uri $uri

Apres : 
http://lapin.com/new/documents/bla
