

= creation de token pour artifactory : ==

on va pouvoir créer un token pour uploader dans artifactory :


 # curl -u lapin:nain01 "http://localhost:8081/artifactory/api/security/token" -d "username=lapin" -d "scope=member-of-groups:lapin-admin"
{
  "scope" : "member-of-groups:lapin-admin api:*",
  "access_token" : "eyJ2ZXIiOiIyIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYiLCJraWQiOiI3anJlQ253cXltbERwN0o2bjFlMjVwZlJhS01KcE5yVWVBTTlFVzRKQWI4In0.eyJzdWIiOiJqZi1hcnRpZmFjdG9yeUBlZDZiNzFmZC1jNzllLTQ2YzAtYmFlZi1jNTBkZjk0OTc3N2VcL3VzZXJzXC9mLnNvYm9uIiwic2NwIjoibWVtYmVyLW9mLWdyb3Vwczpmci5pc3IuZ2cgYXBpOioiLCJhdWQiOiJqZi1hcnRpZmFjdG9yeUBlZDZiNzFmZC1jNzllLTQ2YzAtYmFlZi1jNTBkZjk0OTc3N2UiLCJpc3MiOiJqZi1hcnRpZmFjdG9yeUBlZDZiNzFmZC1jNzllLTQ2YzAtYmFlZi1jNTBkZjk0OTc3N2UiLCJleHAiOjE1NjExMzIzMTksImlhdCI6MTU2MTEyODcxOSwianRpIjoiODBjNDRhOWItYTlhOC00MzM5LWJhMWYtOTQ5ZjFiODJiNmM4In0.DE-V5CVIwvDY0CoqFH_aaTlN8Jp-Rje6l2xpHGlLR86f71bMXD2J0j4qWYZv1PHTZ3TNj7PsqcsSWWREIcOUYusQxGnWflQOmCn5E8QqSCHCB3gNl3SIAqhaZgaRP14LfJn0rfHz_to59BdanwVDoLdzUFhEfczaKOvMNCDmgrbkN3Qbu5sQC0L55SHEQrmgIBcFTlrg6CcFgIGvdSpZxAlInu8_E2kwJajpMDKOfYwqKVpFjCt2xGw_PdkoOCegnwmYWYbrlPmctZMqeTR2JyAojS5yUphl8FzexKdj3sxRUeQGcKLzd0p4SmQNULqEiWjUDIQow9GqWxDqil_A4Q",
  "expires_in" : 3600,
  "token_type" : "Bearer"



== mise a jour de la conf de l'appli :

on peut modifier la conf artifactory : pour la mise a jour il faut l'injecter en http  via un post : 



- on peut faire un dump du fichier de conf chargé par artifactory : on le sauvegarde dans un rep 

curl -u  lapin -X GET -H "Accept: application/xml" http://localhost:8081/artifactory/api/system/configuration | tee /tmp/config.xml

- on fait nos modifs
vi /tmp/config.xml

- on reinjecte notre conf modifiée : 
curl -u lapin  -X POST -H "Content-type:application/xml" -d @/tmp/config.xml http://localhost:8081/artifactory/api/system/configuration



= utilisation d'artifactory comme repo images docker  :=

on va pouvoir setter artifactory comme registry 

on peut pull une image depuis un repo externe et ensuite appeller cette image depuis notre infra 
ex: ici on pull une image depuis le repo kibana 

docker.elastic.co/kibana/kibana mais en passant par notre artifactory qui sert de proxy  
docker pull artifact-docker-mon-repo.net/kibana/kibana:7.3.0

